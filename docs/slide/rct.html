<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ja" xml:lang="ja"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="宋(そん)&nbsp;&nbsp;財泫(じぇひょん)">

<title>社会科学における因果推論 – Causal Inference in Social Science@Kandai</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../figs/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-818fc0ec18eddb34fddef0a4e6b06ca6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-65cf9b68e2eb4073b3e3929739b36804.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "一致なし",
    "search-matching-documents-text": "一致した文書",
    "search-copy-link-title": "検索へのリンクをコピー",
    "search-hide-matches-text": "追加の検索結果を非表示",
    "search-more-match-text": "追加の検索結果",
    "search-more-matches-text": "追加の検索結果",
    "search-clear-button-title": "消去",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "検索",
    "search-label": "サーチ"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9D5YDZ704S"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9D5YDZ704S', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../figs/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Causal Inference in Social Science@Kandai</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="サーチ"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="ナビゲーションを切り替える" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">シラバス</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-rの使い方" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Rの使い方</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-rの使い方">    
        <li>
    <a class="dropdown-item" href="../intro/install.html">
 <span class="dropdown-text">Rの導入</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/rstudio.html">
 <span class="dropdown-text">RStudioの設定</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/filesystem.html">
 <span class="dropdown-text">ファイル・システム</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/project.html">
 <span class="dropdown-text">プロジェクト管理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/file.html">
 <span class="dropdown-text">ファイル管理</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../intro/packages.html">
 <span class="dropdown-text">パッケージ</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">講義資料</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-">    
        <li>
    <a class="dropdown-item" href="../material/intro.html">
 <span class="dropdown-text">ガイダンス</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/foundation.html">
 <span class="dropdown-text">因果推論の考え方</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/rct.html">
 <span class="dropdown-text">無作為化比較試験</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/r.html">
 <span class="dropdown-text">Rの復習</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/matching.html">
 <span class="dropdown-text">回帰分析とマッチング</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/did.html">
 <span class="dropdown-text">差分の差分法</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../material/rdd.html">
 <span class="dropdown-text">回帰不連続デザイン</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../session.html"> 
<span class="menu-text">セッション情報</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://jupyter.cs.rcos.nii.ac.jp/"> <i class="bi bi-terminal" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.jaysong.net/RBook/"> <i class="bi bi-book" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>その他のフォーマット</h2><ul><li><a href="rct.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">社会科学における因果推論</h1>
<p class="subtitle lead">3/ 無作為化比較試験</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">作者</div>
  <div class="quarto-title-meta-heading">所属</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><ruby>宋<rp>(</rp><rt>そん</rt><rp>)</rp></ruby>&nbsp;&nbsp;<ruby>財泫<rp>(</rp><rt>じぇひょん</rt><rp>)</rp></ruby> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            関西大学総合情報学部
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  


</header>


<section id="信頼できるateの条件" class="level2">
<h2 class="anchored" data-anchor-id="信頼できるateの条件">信頼できるATEの条件</h2>
<p><strong>内生性</strong>の存在 <span class="math inline">\(\rightarrow\)</span> ATE推定値の信頼性<span class="math inline">\(\downarrow\)</span></p>
<p>例) やる気のある学生だけがソンさんの講義を履修した場合</p>
<ol type="1">
<li>自己選択バイアス
<ul>
<li>ソンさんの講義は鬼畜すぎるため、やる気満々の学生には役に立つものの、やる気のない学生にとってはむしろ学習意欲が低下</li>
</ul></li>
<li>疑似相関
<ul>
<li>やる気のある学生はいろんな方面で頑張るから、将来年収が高くなる。</li>
</ul></li>
<li>測定誤差
<ul>
<li>履修者の年収はジンバブエ・ドルで測定されている可能性も（これはないか）</li>
</ul></li>
</ol>
<p><br></p>
<center>
<p>内生性は因果推論の敵! どうすれば…?</p>
<p><span class="math inline">\(\downarrow\)</span></p>
<strong>無作為割当</strong> (Random Assignment)
</center>
</section>
<section id="無作為割当とは" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当とは">無作為割当とは</h2>
<p><strong>無作為割当</strong> (Random Assignment)</p>
<ul>
<li>処置を受けるかどうかを無作為に割り当てる方法
<ul>
<li>完全無作為割当: 全ての被験者において、どのグループに属するかの確率が等しい</li>
<li><span class="math inline">\(Pr(T_i = 1) = Pr(T_j = 1) \text{ where } i \neq j\)</span></li>
<li><span class="math inline">\(Pr(T_i = 0) = Pr(T_j = 0) \text{ where } i \neq j\)</span></li>
<li>無作為割当の方法は色々</li>
</ul></li>
<li>無作為に割り当てると、処置を受けないグループと処置を受けるグループは「集団」として同質なグループになる。
<ul>
<li>受けないグループ: <strong>統制群</strong> (Control Group)</li>
<li>受けるグループ: <strong>処置群</strong> (Treatment Group)</li>
</ul></li>
<li><strong>一つの集団を一人の個人として扱い</strong>、ITEを測定 ⇒ ATE</li>
</ul>
</section>
<section id="無作為割当の力" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当の力">無作為割当の力</h2>
<p>コインを投げ、表( <span class="math inline">\(H\)</span> )なら統制群、裏( <span class="math inline">\(T\)</span> )なら処置群に割当</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">データ生成</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>Data</code>の中身</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">19861008</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>               <span class="at">Female =</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-4"><a href="#cb1-4"></a>                               <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>)),</span>
<span id="cb1-5"><a href="#cb1-5"></a>               <span class="at">Age    =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">38</span>, <span class="dv">10</span>), <span class="dv">0</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>Data <span class="sc">|&gt;</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>   <span class="fu">summarise</span>(<span class="at">Female =</span> <span class="fu">mean</span>(Female),</span>
<span id="cb1-9"><a href="#cb1-9"></a>             <span class="at">Age    =</span> <span class="fu">mean</span>(Age))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  Female   Age
   &lt;dbl&gt; &lt;dbl&gt;
1   0.55    38</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="xsyeumcwqw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xsyeumcwqw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xsyeumcwqw thead, #xsyeumcwqw tbody, #xsyeumcwqw tfoot, #xsyeumcwqw tr, #xsyeumcwqw td, #xsyeumcwqw th {
  border-style: none;
}

#xsyeumcwqw p {
  margin: 0;
  padding: 0;
}

#xsyeumcwqw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 32px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xsyeumcwqw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xsyeumcwqw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xsyeumcwqw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xsyeumcwqw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xsyeumcwqw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xsyeumcwqw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xsyeumcwqw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xsyeumcwqw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xsyeumcwqw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xsyeumcwqw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xsyeumcwqw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xsyeumcwqw .gt_spanner_row {
  border-bottom-style: hidden;
}

#xsyeumcwqw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xsyeumcwqw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xsyeumcwqw .gt_from_md > :first-child {
  margin-top: 0;
}

#xsyeumcwqw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xsyeumcwqw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xsyeumcwqw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xsyeumcwqw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xsyeumcwqw .gt_row_group_first td {
  border-top-width: 2px;
}

#xsyeumcwqw .gt_row_group_first th {
  border-top-width: 2px;
}

#xsyeumcwqw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xsyeumcwqw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xsyeumcwqw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xsyeumcwqw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xsyeumcwqw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xsyeumcwqw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xsyeumcwqw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xsyeumcwqw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xsyeumcwqw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xsyeumcwqw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xsyeumcwqw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xsyeumcwqw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xsyeumcwqw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xsyeumcwqw .gt_left {
  text-align: left;
}

#xsyeumcwqw .gt_center {
  text-align: center;
}

#xsyeumcwqw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xsyeumcwqw .gt_font_normal {
  font-weight: normal;
}

#xsyeumcwqw .gt_font_bold {
  font-weight: bold;
}

#xsyeumcwqw .gt_font_italic {
  font-style: italic;
}

#xsyeumcwqw .gt_super {
  font-size: 65%;
}

#xsyeumcwqw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xsyeumcwqw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xsyeumcwqw .gt_indent_1 {
  text-indent: 5px;
}

#xsyeumcwqw .gt_indent_2 {
  text-indent: 10px;
}

#xsyeumcwqw .gt_indent_3 {
  text-indent: 15px;
}

#xsyeumcwqw .gt_indent_4 {
  text-indent: 20px;
}

#xsyeumcwqw .gt_indent_5 {
  text-indent: 25px;
}

#xsyeumcwqw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xsyeumcwqw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="ID...1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ID</th>
<th id="Female...2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Female</th>
<th id="Age...3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Age</th>
<th id="X" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"></th>
<th id="ID...5" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ID</th>
<th id="Female...6" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Female</th>
<th id="Age...7" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Age</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">1</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">31</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">11</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">38</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">2</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">41</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">12</td>
<td class="gt_row gt_right" headers="Female...6">1</td>
<td class="gt_row gt_right" headers="Age...7">29</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">3</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">31</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">13</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">21</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">4</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">46</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">14</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">5</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">37</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">15</td>
<td class="gt_row gt_right" headers="Female...6">1</td>
<td class="gt_row gt_right" headers="Age...7">36</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">6</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">37</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">16</td>
<td class="gt_row gt_right" headers="Female...6">1</td>
<td class="gt_row gt_right" headers="Age...7">40</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">7</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">30</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">17</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">50</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">8</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">46</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">18</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">42</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">9</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">56</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">19</td>
<td class="gt_row gt_right" headers="Female...6">0</td>
<td class="gt_row gt_right" headers="Age...7">29</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">10</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">47</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...5">20</td>
<td class="gt_row gt_right" headers="Female...6">1</td>
<td class="gt_row gt_right" headers="Age...7">47</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="無作為割当の力-1" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当の力-1">無作為割当の力</h2>
<p>コイン投げの結果</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">コイン投げ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false"><code>Data</code>の中身</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">set.seed</span>(<span class="dv">19861008</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>Coin <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"H"</span>, <span class="st">"T"</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>Coin</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "H" "T" "T" "T" "H" "H" "H" "T" "H" "H" "H" "T" "H" "T" "H" "T" "T" "T" "H"
[20] "H"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">table</span>(Coin)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coin
 H  T 
11  9 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Data<span class="sc">$</span>Coin <span class="ot">&lt;-</span> Coin</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="todzftlhwn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#todzftlhwn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#todzftlhwn thead, #todzftlhwn tbody, #todzftlhwn tfoot, #todzftlhwn tr, #todzftlhwn td, #todzftlhwn th {
  border-style: none;
}

#todzftlhwn p {
  margin: 0;
  padding: 0;
}

#todzftlhwn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 32px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#todzftlhwn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#todzftlhwn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#todzftlhwn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#todzftlhwn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#todzftlhwn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#todzftlhwn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#todzftlhwn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#todzftlhwn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#todzftlhwn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#todzftlhwn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#todzftlhwn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#todzftlhwn .gt_spanner_row {
  border-bottom-style: hidden;
}

#todzftlhwn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#todzftlhwn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#todzftlhwn .gt_from_md > :first-child {
  margin-top: 0;
}

#todzftlhwn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#todzftlhwn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#todzftlhwn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#todzftlhwn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#todzftlhwn .gt_row_group_first td {
  border-top-width: 2px;
}

#todzftlhwn .gt_row_group_first th {
  border-top-width: 2px;
}

#todzftlhwn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#todzftlhwn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#todzftlhwn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#todzftlhwn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#todzftlhwn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#todzftlhwn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#todzftlhwn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#todzftlhwn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#todzftlhwn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#todzftlhwn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#todzftlhwn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#todzftlhwn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#todzftlhwn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#todzftlhwn .gt_left {
  text-align: left;
}

#todzftlhwn .gt_center {
  text-align: center;
}

#todzftlhwn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#todzftlhwn .gt_font_normal {
  font-weight: normal;
}

#todzftlhwn .gt_font_bold {
  font-weight: bold;
}

#todzftlhwn .gt_font_italic {
  font-style: italic;
}

#todzftlhwn .gt_super {
  font-size: 65%;
}

#todzftlhwn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#todzftlhwn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#todzftlhwn .gt_indent_1 {
  text-indent: 5px;
}

#todzftlhwn .gt_indent_2 {
  text-indent: 10px;
}

#todzftlhwn .gt_indent_3 {
  text-indent: 15px;
}

#todzftlhwn .gt_indent_4 {
  text-indent: 20px;
}

#todzftlhwn .gt_indent_5 {
  text-indent: 25px;
}

#todzftlhwn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#todzftlhwn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="ID...1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ID</th>
<th id="Female...2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Female</th>
<th id="Age...3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Age</th>
<th id="Coin...4" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Coin</th>
<th id="X" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col"></th>
<th id="ID...6" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">ID</th>
<th id="Female...7" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Female</th>
<th id="Age...8" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Age</th>
<th id="Coin...9" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Coin</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">1</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">31</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">11</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">38</td>
<td class="gt_row gt_left" headers="Coin...9">H</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">2</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">41</td>
<td class="gt_row gt_left" headers="Coin...4">T</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">12</td>
<td class="gt_row gt_right" headers="Female...7">1</td>
<td class="gt_row gt_right" headers="Age...8">29</td>
<td class="gt_row gt_left" headers="Coin...9">T</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">3</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">31</td>
<td class="gt_row gt_left" headers="Coin...4">T</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">13</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">21</td>
<td class="gt_row gt_left" headers="Coin...9">H</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">4</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">46</td>
<td class="gt_row gt_left" headers="Coin...4">T</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">14</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">26</td>
<td class="gt_row gt_left" headers="Coin...9">T</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">5</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">37</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">15</td>
<td class="gt_row gt_right" headers="Female...7">1</td>
<td class="gt_row gt_right" headers="Age...8">36</td>
<td class="gt_row gt_left" headers="Coin...9">H</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">6</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">37</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">16</td>
<td class="gt_row gt_right" headers="Female...7">1</td>
<td class="gt_row gt_right" headers="Age...8">40</td>
<td class="gt_row gt_left" headers="Coin...9">T</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">7</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">30</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">17</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">50</td>
<td class="gt_row gt_left" headers="Coin...9">T</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">8</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">46</td>
<td class="gt_row gt_left" headers="Coin...4">T</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">18</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">42</td>
<td class="gt_row gt_left" headers="Coin...9">T</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="ID...1">9</td>
<td class="gt_row gt_right" headers="Female...2">1</td>
<td class="gt_row gt_right" headers="Age...3">56</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">19</td>
<td class="gt_row gt_right" headers="Female...7">0</td>
<td class="gt_row gt_right" headers="Age...8">29</td>
<td class="gt_row gt_left" headers="Coin...9">H</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="ID...1">10</td>
<td class="gt_row gt_right" headers="Female...2">0</td>
<td class="gt_row gt_right" headers="Age...3">47</td>
<td class="gt_row gt_left" headers="Coin...4">H</td>
<td class="gt_row gt_right" headers="X"></td>
<td class="gt_row gt_right" headers="ID...6">20</td>
<td class="gt_row gt_right" headers="Female...7">1</td>
<td class="gt_row gt_right" headers="Age...8">47</td>
<td class="gt_row gt_left" headers="Coin...9">H</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="無作為割当の力-2" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当の力-2">無作為割当の力</h2>
<p>統制群と処置群が比較的同質的なグループに</p>
<ul>
<li>統制群（11名）: 女性比率が54.5%、平均年齢が37.2歳</li>
<li>処置群 (9名): 女性比率が55.6%、平均年齢が39歳</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>Data <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">group_by</span>(Coin) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">summarise</span>(<span class="at">Female =</span> <span class="fu">mean</span>(Female),</span>
<span id="cb8-4"><a href="#cb8-4"></a>            <span class="at">Age    =</span> <span class="fu">mean</span>(Age),</span>
<span id="cb8-5"><a href="#cb8-5"></a>            <span class="at">N      =</span> <span class="fu">n</span>())</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Coin  Female   Age     N
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 H      0.545  37.2    11
2 T      0.556  39       9</code></pre>
</div>
</div>
</section>
<section id="無作為割当の力-3" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当の力-3">無作為割当の力</h2>
<p>集団として処置群と統制群は、母集団とほぼ同質</p>
<ul>
<li><span class="math inline">\(n \rightarrow \infty\)</span> なら2つのグループはより同質的に（大数の弱法則）</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">女性の割合</th>
<th style="text-align: right;">平均年齢</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">母集団（<span class="math inline">\(n=20\)</span>）</td>
<td style="text-align: right;">55.0%</td>
<td style="text-align: right;">38.0歳</td>
</tr>
<tr class="even">
<td style="text-align: left;">統制群（<span class="math inline">\(n=11\)</span>）</td>
<td style="text-align: right;">54.5%</td>
<td style="text-align: right;">37.2歳</td>
</tr>
<tr class="odd">
<td style="text-align: left;">処置群（<span class="math inline">\(n=9\)</span>）</td>
<td style="text-align: right;">55.6%</td>
<td style="text-align: right;">39.0歳</td>
</tr>
</tbody>
</table>
<ul>
<li>統制群と処置群、母集団はそれぞれ<strong>交換可能</strong>（exchangeable）
<ul>
<li>処置群に処置を与えること = 母集団全体に処置を与えること</li>
<li>統制群に処置を与えないこと = 母集団全体に処置を与えないこと</li>
</ul></li>
<li>統制群と処置群の比較で<strong>集団を一つの単位としたITE（= ATE）</strong>が推定可能
<ul>
<li>処置を与えた母集団 vs.&nbsp;処置を与えなかった母集団</li>
</ul></li>
</ul>
</section>
<section id="無作為割当の力-4" class="level2">
<h2 class="anchored" data-anchor-id="無作為割当の力-4">無作為割当の力</h2>
<p>無作為割当は均質な複数のグループを作る手法</p>
<ul>
<li>講義履修と年収の例だと、無作為割当をすることによって …
<ul>
<li>各グループにやる気のある学生とない学生が均等に
<ul>
<li>自己選択バイアス、擬似相関の除去</li>
</ul></li>
<li>ジンバブエ・ドルで測定される学生も均等に（これはないか）
<ul>
<li>測定誤差の除去</li>
</ul></li>
</ul></li>
<li>内生性:処置変数（講義の履修）と誤差項（やる気など）間の相関
<ul>
<li>コイン投げの結果は被験者（学生）の性質と<strong>無関係</strong>に行われるため、誤差項と相関がない。</li>
<li><strong>外生変数</strong>（Exogenous variable）</li>
<li>学生の性質（<span class="math inline">\(X\)</span>）と処置有無（<span class="math inline">\(T\)</span>）は独立している ⇒ <span class="math inline">\(X \perp T\)</span></li>
</ul></li>
</ul>
<p><br></p>
<center>
<strong>無作為割当は内生性を除去する最良の手法</strong>
</center>
</section>
<section id="無作為抽出と無作為割当" class="level2">
<h2 class="anchored" data-anchor-id="無作為抽出と無作為割当">無作為抽出と無作為割当</h2>
<ul>
<li>無作為<strong>抽出</strong>によってサンプル（標本）と母集団が交換可能（実はここが難しい）</li>
<li>無作為<strong>割当</strong>によって各グループとサンプルに交換可能（=各グループ間で交換可能）</li>
<li>無作為<strong>抽出</strong>&amp;無作為<strong>割当</strong>によって各グループと母集団が交換可能（グループへの刺激=母集団への刺激）</li>
</ul>
<div class="r-stack">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange2.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange3.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange4.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange5.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange6.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/03/Exchange7.png" class="fragment fade-in-then-semi-out img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</section>
<section id="ランダム化比較試験" class="level1 page-columns page-full">
<h1>ランダム化比較試験</h1>
<section id="ランダム化比較試験とは" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="ランダム化比較試験とは">ランダム化比較試験とは</h2>
<p><strong>Randomized Controlled Trial</strong>（RCT）</p>
<ul>
<li>無作為割当で複数のグループを作り上げた上で、異なる刺激・処置を与え、結果を観察する手法
<ul>
<li>社会科学でいう「<strong>実験</strong>」の多くはこれを指す</li>
<li><strong>因果推論の王道</strong></li>
</ul></li>
<li>因果効果をもたらす（と想定される）処置変数が外生的
<ul>
<li>グループ間における結果変数の差 = 因果効果</li>
</ul></li>
<li>データ生成過程（Data Generating Process; <strong>DGP</strong>）への直接介入
<ul>
<li><strong>「真のモデル」が分かる</strong></li>
</ul></li>
</ul>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<ul>
<li>参考）データ生成過程について
<ul>
<li>現実世界において、あるデータが生成されるプロセス
<ul>
<li>例）<span class="math inline">\(Y\)</span>は<span class="math inline">\(X_1\)</span>と<span class="math inline">\(X_2\)</span>の線形結合した値を平均値とする正規分布から生成される。</li>
<li>例） <span class="math display">\[
\begin{align}
\hat{y} &amp; \sim \mbox{Poisson}(\hat{\lambda}), \\
\hat{\lambda} &amp; = e^{\beta_0 + \beta_1 X + \beta_2 Z}.
\end{align}
\]</span></li>
</ul></li>
<li>King, Gary. 1989. <a href="https://www.amazon.co.jp/gp/product/0472085549/"><em>Unifying Political Methodology</em></a>, Michigan University Press.（Ch.1-4）</li>
<li>豊田秀樹. 2022.『<a href="https://www.amazon.co.jp/dp/4254122721/">統計学入門 II: 尤度によるデータ生成過程の表現</a>』朝倉書店</li>
</ul></li>
</ul>
</div></div></section>
<section id="データ生成過程への介入" class="level2">
<h2 class="anchored" data-anchor-id="データ生成過程への介入">データ生成過程への介入</h2>
<p><span class="math display">\[
\mbox{Income} = \beta_0 + \beta_1 \cdot \mbox{Quant} + \varepsilon
\]</span></p>
<ul>
<li>Income：10年後の年収（<span class="math inline">\(\in [0, \infty)\)</span>）</li>
<li>Quant：ソンさんの講義を履修したか否か（<span class="math inline">\(\in \{0, 1\})\)</span>）</li>
<li>誤差項(<span class="math inline">\(\varepsilon\)</span>)には「やる気」や「真面目さ」が含まれるため、Quantと相関がある（<span class="math inline">\(\rightarrow\)</span> <strong>内生性</strong>）</li>
<li>無作為割当で受講有無を決めると、「やる気」や「真面目さ」はQunatと無関係（<strong>独立</strong>）になる
<ul>
<li>例) 受講有無をコイン投げ（<span class="math inline">\(W\)</span>）で決める場合、コインの結果は誤差項（やる気や真面目さ）と独立（ただし、全員がコイン投げの結果に従うと仮定）</li>
<li><span class="math inline">\(\Rightarrow\)</span> 内生性がなくなる!</li>
</ul></li>
</ul>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rct_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1800"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rct_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1800"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="実験の方法" class="level2">
<h2 class="anchored" data-anchor-id="実験の方法">実験の方法</h2>
<p>Hyde (2015) による分類</p>
<ul>
<li>フィールド実験: 実際の社会を舞台に行う実験
<ul>
<li>Gerber, Alan S. and Donald P. Green. 2012. <a href="https://www.amazon.co.jp/dp/0393979954/"><em>Field Experiments</em></a>, Norton.</li>
</ul></li>
<li>実験室実験: 人為的に作られた（=統制された）環境内で行う実験</li>
<li>サーベイ実験: 世論調査に埋め込む実験
<ul>
<li>SONG Jaehyun・秦正樹. 2020. 「<a href="https://doi.org/10.11218/ojjams.35.92">オンライン・サーベイ実験の方法: 理論編</a>」『理論と方法』35 (1): 92-108.</li>
<li>秦正樹・SONG Jaehyun. 2020. 「<a href="https://doi.org/10.11218/ojjams.35.109">オンライン・サーベイ実験の方法: 実践編</a>」『理論と方法』35 (1): 109-127.</li>
</ul></li>
</ul>
</section>
<section id="フィールド実験1" class="level2">
<h2 class="anchored" data-anchor-id="フィールド実験1">フィールド実験（1）</h2>
<p>実際の社会を舞台に行う実験</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">例1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">例2</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Ito, Koichiro, Takanori Ida, and Makoto Tanaka. 2018. “<a href="https://www.aeaweb.org/articles?id=10.1257/pol.20160093">Moral Suasion and Economic Incentives: Field Experimental Evidence from Energy Demand</a>,” <em>American Economic Journal: Economic Policy,</em> 10 (1): 240-267.</p>
<ul>
<li>京都府内の691世帯が対象</li>
<li>電気メーターを設置し、統制群と処置群1、処置群2に分割
<ul>
<li>設置のみ (153) / 単純節電要請 (154) / 動機づけ節電要請 (384)</li>
</ul></li>
<li>電気使用量の比較</li>
</ul>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Gerber, Alan S., Donald P. Green, and Christopher W. Larimer. 2010. “<a href="https://link.springer.com/article/10.1007/s11109-010-9110-4">An Experiment Testing the Relative Effectiveness of Encouraging Voter Participation by Inducing Feelings of Pride or Shame</a>,” <em>Political Behavior,</em> 32: 409-422.</p>
<ul>
<li>ミシガン州の18万世帯が対象</li>
<li>4つの処置群にそれぞれ異なる投票を促す内容の葉書を発送
<ul>
<li>統制群: 99,999世帯 / 処置群1: 20,001世帯 / 処置群2: 20,002世帯 / 処置群3: 20,00 世帯 / 処置群4: 20,000世帯</li>
</ul></li>
<li>それぞれのグループ間の投票率を比較</li>
</ul>
</div>
</div>
</div>
</section>
<section id="フィールド実験2" class="level2">
<h2 class="anchored" data-anchor-id="フィールド実験2">フィールド実験（2）</h2>
<ul>
<li>メリット
<ul>
<li>実際の社会と対象にするため、高い外的妥当性
<ul>
<li>一般的に外的妥当性は実験研究の最大の弱点とも言われる</li>
<li>ただし、全国民ではなく、一部の地域を対象にするケースが多いため、限界もある
<ul>
<li>Ito, Ida and Tanaka (2018) は外的妥当性の確保のために同様の実験を京都以外でも実施 (京都市、横浜市、北九州市、豊田市)</li>
</ul></li>
</ul></li>
</ul></li>
<li>デメリット
<ul>
<li>高費用
<ul>
<li>Gerber, Green, and Larimer (2010) は安い方?
<ul>
<li>アメリカで切手は100円以上の場合が多いため、18万世帯$$100円だけでも1800万円</li>
<li>葉書もタダじゃない (Amazon.comで100枚12ドル程度)</li>
</ul></li>
<li>Ito, Ida and Tanaka (2018) は . . .</li>
</ul></li>
</ul></li>
<li>政府や企業などの協力なしでは実施が困難なケースが多い</li>
</ul>
</section>
<section id="実験室実験1" class="level2">
<h2 class="anchored" data-anchor-id="実験室実験1">実験室実験（1）</h2>
<p>人為的に作られた環境内で行う実験</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">例1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">例2</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>Blais, André, Simon Labbé-St-Vincent, Laslier Jean-François, Nicolas Sauger, and Karine Van der Straeten. 2011. “<a href="https://journals.sagepub.com/doi/full/10.1177/1065912909358583">Strategic Vote Choice in One-Round and Two-Round Elections: An Experimental Study</a>,” <em>Political Research Quarterly,</em> 64(3): 637–645.</p>
<ul>
<li>42名 <span class="math inline">\(\times\)</span> 2グループ
<ul>
<li>グループ1：一回投票制4回 <span class="math inline">\(\rightarrow\)</span> 二回投票制4回</li>
<li>グループ2：二回投票制4回 <span class="math inline">\(\rightarrow\)</span> 一回投票制4回</li>
</ul></li>
<li>投票方式による戦略投票（Strategic Vote）の傾向を比較</li>
</ul>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Mueller, Pam A. and Daniel M. Oppenheimer. 2014. “<a href="https://journals.sagepub.com/doi/full/10.1177/0956797614524581">The Pen Is Mightier Than the Keyboard: Advantages of Longhand Over Laptop Note Taking</a>,” <em>Psychological Science,</em> 25(6): 1159-1168.</p>
<ul>
<li>学生を2グループに分割
<ul>
<li>グループ 1: ノートパソコンでノートテイキング</li>
<li>グループ 2: ノートとペンでノートテイキング</li>
</ul></li>
<li>レクチャーの理解度をグループごとに比較</li>
</ul>
</div>
</div>
</div>
</section>
<section id="実験室実験2" class="level2">
<h2 class="anchored" data-anchor-id="実験室実験2">実験室実験（2）</h2>
<ul>
<li>メリット
<ul>
<li>環境を自由に操作できる</li>
<li>被験者の訓練・統制が容易
<ul>
<li>実験前のルールの説明など</li>
</ul></li>
</ul></li>
<li>デメリット
<ul>
<li>被験者の属性が偏りやすい <span class="math inline">\(\Rightarrow\)</span> 低い外的妥当性
<ul>
<li>主に学生が動員される</li>
<li>Hovland (1959): “College sophomores may not be people.”</li>
</ul></li>
</ul></li>
<li>トレードオフ
<ul>
<li>一般的に、被験者が少数
<ul>
<li>Small <span class="math inline">\(N\)</span> <span class="math inline">\(\leftrightarrow\)</span> 低コスト<del>(単位を餌にする研究者ならタダでできる)</del></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="サーベイ実験1" class="level2">
<h2 class="anchored" data-anchor-id="サーベイ実験1">サーベイ実験（1）</h2>
<p>世論調査に実験を埋め込む方法</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">例1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">例2</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>Asaba, Yuki, Kyu S Hahn, Seulgi Jang, Tetsuro Kobayashi, and Atsushi Tago. 2020. “<a href="https://academic.oup.com/irap/article/20/2/253/5151306">38 seconds above the 38th parallel: how short video clips produced by the US military can promote alignment despite antagonism between Japan and Korea</a>,” <em>International Relations of the Asia-Pacific,</em> 20(2): 253–273.</p>
<ul>
<li>サーベイの回答者1500名を2グループに分割
<ul>
<li>統制群：38秒の日米韓軍事協力に関するPACOM制作の動画を視聴</li>
<li>処置群：ほぼ同じ長さのPACOM制作の動画を視聴（日韓の言及はなし）</li>
</ul></li>
<li>アメリカに対する感情温度、日韓協力に対する態度を測定</li>
<li>グループごとに結果を比較</li>
</ul>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Song, Jaehyun, Takeshi Iida, Yuriko Takahashi, and Jesús Tovar. 2022. “<a href="https://www.waseda.jp/fpse/winpec/public/working-paper/">Buying Votes across Borders? A List Experiment on Mexican Immigrants in the US</a>,” <em>Canadian Journal of Political Science,</em> 55 (4): 852-872.</p>
<ul>
<li>回答者621名を統制群と処置群に割当</li>
<li>統制群に以下のように質問</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Now we are going to show you four activities that some people may experience during the electoral campaign. After you read all four, just answer HOW MANY activities you experienced during the last electoral campaign. (We do NOT want to know which ones, just how many.)</p>
<ul>
<li>I saw public debates between candidates for presidential elections on TV.</li>
<li>I saw official websites/blogs of politicians and candidates.</li>
<li>My family/friends told me about the election.</li>
<li>Campaign activists threatened me to vote for a candidate.</li>
</ul>
</div>
</div>
</div>
<ul>
<li>処置群には「<strong>Campaign activists gave any monetary benefits or did a favor to me or my family in Mexico.</strong>」を追加</li>
<li>結果の平均値を比較</li>
</ul>
</div>
</div>
</div>
</section>
<section id="サーベイ実験2" class="level2">
<h2 class="anchored" data-anchor-id="サーベイ実験2">サーベイ実験（2）</h2>
<ul>
<li>メリット
<ul>
<li>コストが低い (数万円で<strong>一応</strong>実施可能OK)</li>
<li>大規模の実験が可能（数百人〜数千人）</li>
<li>機動性が高い</li>
<li>SUTVA（後述）が満たされやすい</li>
</ul></li>
<li>デメリット
<ul>
<li>実際の環境を再現するのが困難（外的妥当性の問題）</li>
<li>「行動」を対象とした場合、測定尺度の問題</li>
<li>不良回答者（satisficer）の存在</li>
<li>実験のトラブルに対応するのが困難</li>
</ul></li>
</ul>
</section>
<section id="rctの例" class="level2">
<h2 class="anchored" data-anchor-id="rctの例">RCTの例</h2>
<p>Bertrand, Marianne, and Sendhil Mullainathan. 2004. “<a href="https://www.aeaweb.org/articles?id=10.1257/0002828042002561">Are Emily and Greg More Employable Than Lakisha and Jamal? A Field Experiment on Labor Market Discrimination</a>,” <em>American Economic Review</em>, 94(4): 991-1013.</p>
<ul>
<li>労働市場における人種差別</li>
<li>約5000人分の架空の履歴書を求人中の会社へ送る
<ul>
<li>履歴書の内容 (性別、人種、能力など) は<strong>完全無作為</strong></li>
<li>履歴書に人種は記入できないため、白人っぽい名前 (Emily など)、黒人っぽい名前 (Jamal など) を記入</li>
</ul></li>
<li>後は、返事を待つだけ</li>
</ul>
<p><strong>処置変数:</strong> 人種 ( <span class="math inline">\(\in \{\text{black}, \text{white}\}\)</span> )</p>
<p><strong>結果変数:</strong> 連絡の有無 ( <span class="math inline">\(\in \{0, 1\}\)</span> )</p>
</section>
<section id="内生性の可能性" class="level2">
<h2 class="anchored" data-anchor-id="内生性の可能性">内生性の可能性</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rct_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1500"></p>
</figure>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:55%;">
<ul>
<li>誤差項には教育水準、親の所得、居住地などが含まれる
<ul>
<li>実際に人種と上記の要因には相関あり</li>
<li>人種 (処置) と誤差項間の相関関係 <span class="math inline">\(\rightarrow\)</span> <strong>内生性</strong></li>
</ul></li>
<li>黒人が採用されなかった場合…
<ul>
<li>黒人だから? <span class="math inline">\(\leftarrow\)</span> 人種差別<span class="math inline">\(\bigcirc\)</span></li>
<li>教育水準が低いから <span class="math inline">\(\leftarrow\)</span> 人種差別<span class="math inline">\(\times\)</span></li>
</ul></li>
</ul>
</div><div class="column" style="width:45%;">
<p><br><br> <span class="math inline">\(\Rightarrow\)</span> 内生性がある限り、因果効果の識別は困難 <br><br><br><br> <span class="math inline">\(\Rightarrow\)</span> ケースによって政策的含意が変わる。</p>
</div>
</div>
</section>
<section id="rctの力" class="level2">
<h2 class="anchored" data-anchor-id="rctの力">RCTの力</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">白人の名前</th>
<th style="text-align: right;">黒人の名前</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">76.42%</td>
<td style="text-align: right;">77.45%</td>
</tr>
<tr class="even">
<td style="text-align: left;">HighQuality</td>
<td style="text-align: right;">50.23%</td>
<td style="text-align: right;">50.23%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Call Rate</td>
<td style="text-align: right;">9.65%</td>
<td style="text-align: right;">6.45%</td>
</tr>
<tr class="even">
<td style="text-align: left;">計 (人)</td>
<td style="text-align: right;">2435</td>
<td style="text-align: right;">2435</td>
</tr>
</tbody>
</table>
<ul>
<li>無作為割当の結果、人種と性別・能力の相関がほぼ0に
<ul>
<li>内生性のない状態</li>
<li>この場合、労働市場における人種の因果効果は
<ul>
<li>ATE = 黒人の平均連絡率 − 白人の平均連絡率</li>
<li>黒人という理由だけで会社から連絡が来る確率が 3.2%p<span class="math inline">\(\downarrow\)</span></li>
<li>-3.2%p: 人種の<strong>因果効果</strong> or <strong>処置効果</strong> (treatment effect)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="バランスチェック" class="level2">
<h2 class="anchored" data-anchor-id="バランスチェック">バランスチェック</h2>
<p>無作為割当が行われているか否かを確認</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center" data-cahce="true">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rct_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="1500"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>標準化差分</strong>を使用</p>
<ul>
<li>Standardized Bias (or Difference)
<ul>
<li>サンプルサイズの影響<span class="math inline">\(\times\)</span></li>
<li>統計的検定ではない</li>
</ul></li>
<li><span class="math inline">\(t\)</span> 検定、ANOVA、 <span class="math inline">\(\chi^2\)</span> 検定は<span class="math inline">\(\times\)</span>
<ul>
<li>バランスチェックに統計的有意性検定は使わない</li>
</ul></li>
<li><a href="https://ngreifer.github.io/cobalt/">{cobalt}</a>、<a href="https://github.com/JaehyunSong/BalanceR">{BalanceR}</a>など</li>
</ul>
</div>
</div>
</section>
<section id="標準化差分について" class="level2">
<h2 class="anchored" data-anchor-id="標準化差分について">標準化差分について</h2>
<p>連続変数</p>
<p><span class="math display">\[
\text{SB}_{T-C} = 100 \cdot \frac{\bar{X}_T - \bar{X}_C}{\sqrt{0.5 \cdot (s_T^2 + s_C^2)}}
\]</span></p>
<p>二値変数</p>
<p><span class="math display">\[
\text{SB}_{T-C} = 100 \cdot \frac{\bar{X}_T - \bar{X}_C}{\sqrt{0.5 \cdot (\bar{X}_T(1-\bar{X}_T) + \bar{X}_C(1-\bar{X}_C))}}
\]</span></p>
<ul>
<li><span class="math inline">\(\bar{X}_T\)</span> : 処置群におけるXの平均値</li>
<li><span class="math inline">\(s_T^2\)</span> : 処置群におけるXの分散</li>
<li>|SB|が小さいほどバランス
<ul>
<li>明確な基準はないが、3、5、10、25などを使用</li>
</ul></li>
<li>グループが3つ以上の場合、それぞれのペアで実行</li>
</ul>
</section>
<section id="因果効果の推定" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="因果効果の推定">因果効果の推定</h2>
<div class="tabset-margin-container page-columns page-full"><div class="no-row-height column-margin column-container"><div class="margin-aside tabset-margin-content tabset-6-2-tab-margin-content collapse">
<p>参考）Freedman, David A. 2008. “<a href="https://www.jstor.org/stable/27645896">Randomization Does Not Justify Logistic Regression</a>,” <em>Statistical Science Statistical Science,</em> 23(2): 237-249.</p>
<ul>
<li>Logit: 一致推定量<span class="math inline">\(\times\)</span> &amp; 不偏推定量<span class="math inline">\(\times\)</span></li>
<li>Linear: 一致推定量<span class="math inline">\(\bigcirc\)</span> &amp; 不偏推定量<span class="math inline">\(\times\)</span></li>
<li><a href="https://www.jaysong.net/notes/simulation/consistency.html">一致性と不偏性の違いについて</a></li>
</ul>
</div></div></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">平均値の差分の検定</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">単回帰分析</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p><strong>方法1:</strong> グループ間の結果変数の差分の検定 (<span class="math inline">\(t\)</span>検定)</p>
<ul>
<li>因果効果 (ATE): <span class="math inline">\(\mathbb{E}[\mbox{Call}|\mbox{Race = Black}] - \mathbb{E}[\mbox{Call}|\mbox{Race = White}] = -0.032\)</span></li>
<li>ATE = 0の帰無仮説の検定
<ul>
<li><span class="math inline">\(t_{\text{df} = 4711.7} = −4.117\)</span>; <span class="math inline">\(p\)</span> &lt; 0.001; 95% CI = [−0.047, −0.017]</li>
</ul></li>
<li>応答変数の尺度に応じてノンパラメトリック分析</li>
</ul>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p><strong>方法2:</strong> 単回帰分析 (線形 or ロジスティックス/プロビット)</p>
<center>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<caption>線形回帰分析（LPM）</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Covriates</th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">S.E.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Race: White</td>
<td style="text-align: right;"><strong>0.032</strong></td>
<td style="text-align: right;">0.008</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<caption>ロジスティック回帰分析</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Covriates</th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">S.E.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">-2.675</td>
<td style="text-align: right;">0.083</td>
</tr>
<tr class="even">
<td style="text-align: left;">Race: White</td>
<td style="text-align: right;"><strong>0.438</strong></td>
<td style="text-align: right;">0.107</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<table class="caption-top table">
<caption>プロビット回帰分析</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Covriates</th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">S.E.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">-1.518</td>
<td style="text-align: right;">0.039</td>
</tr>
<tr class="even">
<td style="text-align: left;">Race: White</td>
<td style="text-align: right;"><strong>0.217</strong></td>
<td style="text-align: right;">0.053</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</center>

</div>
</div>
</div>
</section>
<section id="因果効果の推定重回帰分析は" class="level2">
<h2 class="anchored" data-anchor-id="因果効果の推定重回帰分析は">因果効果の推定：重回帰分析は?</h2>
<p>無作為割当のおかげですべての変数が互いに独立</p>
<ul>
<li>重回帰分析をしても人種のATEは変化しない (OVB がない)
<ul>
<li>無作為割当の場合、回帰は<strong>してもしなくても</strong>良い</li>
</ul></li>
<li>現実的に<strong>完全に</strong>バランスが取れていないため、若干の変化はある</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Covriates</th>
<th style="text-align: right;">Est.</th>
<th style="text-align: right;">S.E.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">0.007</td>
</tr>
<tr class="even">
<td style="text-align: left;">Race: White</td>
<td style="text-align: right;"><strong>0.032</strong></td>
<td style="text-align: right;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Female</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.009</td>
</tr>
<tr class="even">
<td style="text-align: left;">Military</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">0.014</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education</td>
<td style="text-align: right;">-0.002</td>
<td style="text-align: right;">0.005</td>
</tr>
<tr class="even">
<td style="text-align: left;">High Quality</td>
<td style="text-align: right;">0.019</td>
<td style="text-align: right;">0.008</td>
</tr>
</tbody>
</table>
</section>
<section id="因果効果の不均一性" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="因果効果の不均一性">因果効果の不均一性</h2>
<p>因果効果が下位グループによって異なる場合</p>
<ul>
<li><strong>因果効果の不均一性</strong> (heterogeneous treatment effects)
<ul>
<li>例) 性別によって薬の効果が異なる場合</li>
<li>薬の効果が男性なら 1、女性なら 2 の場合
<ul>
<li>男女比が1:1なら、ATEは1.5に</li>
</ul></li>
<li>薬の効果が男性なら 4、女性なら-1 の場合
<ul>
<li>男女比が1:1なら、ATEは1.5だが…</li>
</ul></li>
</ul></li>
<li><strong>方法1:</strong> 男女に分けてATEを推定</li>
<li><strong>方法2:</strong> 性別と処置有無の交差項を投入した重回帰分析</li>
</ul>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>参考) Bryan, Christopher J., Elizabeth Tipton and David S. Yeager. 2021. “<a href="https://www.nature.com/articles/s41562-021-01143-3">Behavioural science is unlikely to change the world without a heterogeneity revolution</a>,” <em>Nature Human Behaviour.</em> 5: 980–989.</p>
</div></div></section>
<section id="因果効果の不均一性intro_data2.csv" class="level2">
<h2 class="anchored" data-anchor-id="因果効果の不均一性intro_data2.csv">因果効果の不均一性（<code>intro_data2.csv</code>）</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/intro_data2.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 500 × 4
      ID Outcome Treatment Female
   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;
 1     1  1.09           0      1
 2     2  0.0281         0      1
 3     3  1.65           0      0
 4     4  3.83           1      1
 5     5  2.65           1      1
 6     6  1.24           1      1
 7     7  0.136          1      0
 8     8  0.507          0      1
 9     9  2.99           1      1
10    10  4.34           1      1
# ℹ 490 more rows</code></pre>
</div>
</div>
</section>
<section id="因果効果の不均一性-1" class="level2">
<h2 class="anchored" data-anchor-id="因果効果の不均一性-1">因果効果の不均一性</h2>
<p><strong>方法1:</strong> 男女に分けてATEを推定</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">比較</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">コード1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">コード2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">コード3</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">統制群</th>
<th style="text-align: right;">処置群</th>
<th style="text-align: right;">ATE</th>
<th style="text-align: right;"><span class="math inline">\(t\)</span></th>
<th style="text-align: right;"><span class="math inline">\(p\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">男性のみ</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">1.561</td>
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">-7.521</td>
<td style="text-align: right;">&lt; 0.001</td>
</tr>
<tr class="even">
<td style="text-align: left;">女性のみ</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">2.480</td>
<td style="text-align: right;">1.987</td>
<td style="text-align: right;">-15.573</td>
<td style="text-align: right;">&lt; 0.001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">全体</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">2.057</td>
<td style="text-align: right;">1.506</td>
<td style="text-align: right;">-15.945</td>
<td style="text-align: right;">&lt; 0.001</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>男性のみ</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">t.test</span>(Outcome <span class="sc">~</span> Treatment, <span class="at">data =</span> data2, <span class="at">subset =</span> (Female <span class="sc">==</span> <span class="dv">0</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Outcome by Treatment
t = -7.5211, df = 235.95, p-value = 1.132e-12
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -1.1996845 -0.7016501
sample estimates:
mean in group 0 mean in group 1 
      0.6105137       1.5611810 </code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<p>女性のみ</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">t.test</span>(Outcome <span class="sc">~</span> Treatment, <span class="at">data =</span> data2, <span class="at">subset =</span> (Female <span class="sc">==</span> <span class="dv">1</span>))</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Outcome by Treatment
t = -15.573, df = 259.72, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -2.238053 -1.735599
sample estimates:
mean in group 0 mean in group 1 
      0.4931905       2.4800169 </code></pre>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<p>全体</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">t.test</span>(Outcome <span class="sc">~</span> Treatment, <span class="at">data =</span> data2)</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  Outcome by Treatment
t = -15.945, df = 494.24, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -1.692061 -1.320817
sample estimates:
mean in group 0 mean in group 1 
      0.5509135       2.0573524 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="因果効果の不均一性-2" class="level2">
<h2 class="anchored" data-anchor-id="因果効果の不均一性-2">因果効果の不均一性</h2>
<p><strong>方法2:</strong> 性別と処置有無の交差項を投入した重回帰分析</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">lm</span>(Outcome <span class="sc">~</span> Treatment <span class="sc">*</span> Female, </span>
<span id="cb18-2"><a href="#cb18-2"></a>   <span class="at">data =</span> data2) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>   <span class="fu">summary</span>()</span></code><button title="コピー" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_590ssv9bp71tefz34jha(i, j, css_id) {
          var table = document.getElementById("tinytable_590ssv9bp71tefz34jha");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_590ssv9bp71tefz34jha');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_590ssv9bp71tefz34jha(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_590ssv9bp71tefz34jha");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 7, j: 0 },  ], css_id: 'tinytable_css_pbcpqebxyrbmng6pmelu',}, 
          { positions: [ { i: 1, j: 0 }, { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 },  ], css_id: 'tinytable_css_jyah0fokttwfe693lift',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_itv75376v42r1698z1d8',}, 
          { positions: [ { i: 4, j: 0 },  ], css_id: 'tinytable_css_d25lgf86foa7vd5pq81c',}, 
          { positions: [ { i: 1, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 5, j: 1 }, { i: 6, j: 1 },  ], css_id: 'tinytable_css_7neretjgxtvjmikd2e85',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_4nigf3jcd5j9bx4dcs4t',}, 
          { positions: [ { i: 4, j: 1 },  ], css_id: 'tinytable_css_2duh046qdff7haw2m997',}, 
          { positions: [ { i: 7, j: 1 },  ], css_id: 'tinytable_css_06mm3e42g1bqiyc5udhq',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_590ssv9bp71tefz34jha(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_pbcpqebxyrbmng6pmelu, .table th.tinytable_css_pbcpqebxyrbmng6pmelu { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_jyah0fokttwfe693lift, .table th.tinytable_css_jyah0fokttwfe693lift { text-align: left; }
      .table td.tinytable_css_itv75376v42r1698z1d8, .table th.tinytable_css_itv75376v42r1698z1d8 { text-align: left; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_d25lgf86foa7vd5pq81c, .table th.tinytable_css_d25lgf86foa7vd5pq81c { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_7neretjgxtvjmikd2e85, .table th.tinytable_css_7neretjgxtvjmikd2e85 { text-align: right; }
      .table td.tinytable_css_4nigf3jcd5j9bx4dcs4t, .table th.tinytable_css_4nigf3jcd5j9bx4dcs4t { text-align: right; border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_2duh046qdff7haw2m997, .table th.tinytable_css_2duh046qdff7haw2m997 { text-align: right; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_06mm3e42g1bqiyc5udhq, .table th.tinytable_css_06mm3e42g1bqiyc5udhq { text-align: right; border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_590ssv9bp71tefz34jha" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>(Intercept)</td>
                  <td>0.611 (0.091)</td>
                </tr>
                <tr>
                  <td>Treatment</td>
                  <td>0.951 (0.131)</td>
                </tr>
                <tr>
                  <td>Female</td>
                  <td>-0.117 (0.127)</td>
                </tr>
                <tr>
                  <td>Treatment × Female</td>
                  <td>1.036 (0.180)</td>
                </tr>
                <tr>
                  <td>Num.Obs.</td>
                  <td>500</td>
                </tr>
                <tr>
                  <td>R2 Adj.</td>
                  <td>0.398</td>
                </tr>
                <tr>
                  <td>F</td>
                  <td>110.905</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\begin{align}
\hat{y} = &amp; \beta_0 + \beta_1 \mbox{Treatment} + \beta_2 \mbox{Female} + \\
&amp; \beta_3 \mbox{Treatment} \cdot \mbox{Female} \\
= &amp; \beta_0 + (\beta_1 + \beta_3 \mbox{Female}) \mbox{Treatment} + \beta_2 \mbox{Female}.
\end{align}
\]</span></p>
<ul>
<li>処置効果はTreatmentの係数
<ul>
<li><span class="math inline">\(\beta_1 + \beta_3 \mbox{Female}\)</span></li>
<li><span class="math inline">\(\Rightarrow\)</span> 処置効果がFemaleの値にも依存</li>
</ul></li>
<li>男性のATE: <span class="math inline">\(\beta_1 + \beta_3 \cdot 0 = \beta_1\)</span> = 0.951</li>
<li>女性のATE: <span class="math inline">\(\beta_1 + \beta_3 \cdot 1 = \beta_1 + \beta_3\)</span> = 1.987</li>
</ul>
</div>
</div>
</section>
<section id="因果推論の前提sutva" class="level2">
<h2 class="anchored" data-anchor-id="因果推論の前提sutva">因果推論の前提:SUTVA</h2>
<p><strong>Stable Unit Treatment Value Assumption</strong></p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">非干渉性</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">処置の無分散性</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">サーベイ実験の場合</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p><strong>非干渉性:</strong> 他人の処置・統制有無が処置効果に影響を与えないこと</p>
<ul>
<li>例) AさんITEは
<ul>
<li>例1) Bさんが統制群の場合は10、処置群の場合は5 <span class="math inline">\(\leftarrow\)</span> <i class="bi bi-emoji-frown"></i></li>
<li>例2) Bさんが統制群の場合も、処置群の場合も、5 <span class="math inline">\(\leftarrow\)</span> <i class="bi bi-emoji-smile"></i></li>
</ul></li>
</ul>
<center>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>例1</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Aさんが統制群</th>
<th style="text-align: left;">Aさんが処置群</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bさんが統制群</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bさんが処置群</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">20</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<caption>例2</caption>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">Aさんが統制群</th>
<th style="text-align: left;">Aさんが処置群</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bさんが統制群</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bさんが処置群</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</center>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p><strong>処置の無分散性:</strong> 同じグループに属する対象は同じ処置を受けること</p>
<ul>
<li>手術の場合：医者、設備、手順、環境など</li>
<li>投票参加：当日、期日前など</li>
</ul>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<ul>
<li>サーベイ実験ではSUTVAが満たされやすい。
<ul>
<li>実験室実験、フィールド実験の場合、「非干渉性」には気をつける。</li>
<li>例) 隣の人が見てるのとと私が見てるのが違いますが…?</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
<section id="二重盲検法" class="level2">
<h2 class="anchored" data-anchor-id="二重盲検法">二重盲検法</h2>
<p><strong>二重盲検法</strong>（Double Blind Test）：ある被験者がどのような処置を受けているかについて研究者と被験者両方において不明な状態で実験を行うこと</p>
<p><br></p>
<p>二重盲検法を使えば以下の問題点に対処することが可能</p>
<ul>
<li><strong>プラセボ効果</strong>（placebo effect）：偽薬が与えられても、薬だと信じ込む 事によって何らかの効果が生じる</li>
<li><strong>ホーソン効果</strong>（Hawthorne effect）：自分が観察されていることを認知さ れることによって何らかの効果が生じる</li>
<li><strong>観察者効果</strong>（observer/experimenter effect）：研究者の期待により被験者へ の対応が異なったり、被験者がその期待に添えるように行動すること</li>
</ul>
</section>
</section>
<section id="来週以降の実習について" class="level1">
<h1>来週以降の実習について</h1>
<section id="用意するもの" class="level2">
<h2 class="anchored" data-anchor-id="用意するもの">用意するもの</h2>
<p>第4、5、6回はRの実習</p>
<ul>
<li>ノートPC
<ul>
<li>デスクトップ、モニター、キーボード、マウスが持ち込めるなら、デスクトップでもOK（がんばって！！）</li>
</ul></li>
<li>Rの導入（いずれの方法でもOK）
<ul>
<li>自分のPCにR/RStudioをインストールし使用する。</li>
<li>JDCat分析ツール（クラウド版のR + RStudio）を使用する。</li>
</ul></li>
<li>ブラインドタッチ</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "コピーしました");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "コピーしました");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.jaysong\.net\/kandai-ci\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2022, <a href="https://www.jaysong.net" target="_blank">Jaehyun Song</a>. Powered by <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.jaysong.net">
      <i class="bi bi-house-fill" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/JaehyunSong">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>